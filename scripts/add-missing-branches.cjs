// Add missing dark_energy and dark_click nodes to balance.json
const fs = require('fs');
const path = require('path');

const balancePath = path.join(__dirname, '../src/data/balance.json');
const data = JSON.parse(fs.readFileSync(balancePath, 'utf8'));

// Cost progression matches existing pattern (exponential growth ~2.2x)
const costs = [22, 48, 106, 234, 515, 1133, 2494, 5487, 12072, 26559, 58431, 128550, 282810, 622182, 1368801, 3011363, 6625001, 14575002, 32065005, 70543011, 155194225, 341427295, 751140049, 1652508108, 3635517838];

// Generate dark_energy nodes (arm 1)
for (let i = 1; i <= 25; i++) {
    const id = `dark_energy_${i}`;
    const tier = Math.ceil(i / 5); // Groups of 5
    const isOdd = i % 2 === 1;

    data.darkMatterUpgrades[id] = {
        id,
        name: `Energy Node ${i}`,
        description: `Tier ${tier} Energy enhancement.`,
        cost: costs[i - 1],
        position: { x: 0, y: 0 }, // Will be regenerated by spiral script
        parent: i === 1 ? 'dark_core' : `dark_energy_${i - 1}`,
        branch: 'energy',
        effect: {
            type: isOdd ? 'globalProductionMult' : 'globalCostScale',
            value: isOdd ? 1.1 + (i * 0.05) : 0.986 - (i * 0.004)
        }
    };
}

// Generate dark_click nodes (arm 3)
for (let i = 1; i <= 25; i++) {
    const id = `dark_click_${i}`;
    const tier = Math.ceil(i / 5);
    const isOdd = i % 2 === 1;

    data.darkMatterUpgrades[id] = {
        id,
        name: `Click Node ${i}`,
        description: `Tier ${tier} Click enhancement.`,
        cost: costs[i - 1],
        position: { x: 0, y: 0 }, // Will be regenerated by spiral script
        parent: i === 1 ? 'dark_core' : `dark_click_${i - 1}`,
        branch: 'click',
        effect: {
            type: isOdd ? 'clickPowerMult' : 'globalProductionMult',
            value: isOdd ? 1.2 + (i * 0.05) : 1.1 + (i * 0.04)
        }
    };
}

// Write back
fs.writeFileSync(balancePath, JSON.stringify(data, null, 4));
console.log('âœ… Added 25 dark_energy and 25 dark_click nodes');
console.log(`Total nodes now: ${Object.keys(data.darkMatterUpgrades).length}`);
